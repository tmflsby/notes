<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
<script src="https://cdn.bootcss.com/bluebird/3.5.1/bluebird.min.js"></script>
<!-- 如果低版本浏览器不支持Promise，通过cdn这种方式 -->
<!-- <script>
function loadImg(src) {
    let promise = new Promise(function(resolve, reject) {
        let img = document.createElement('img')
        img.onload = function() {
            resolve(img)
        }
        img.onerror = function() {
            reject('图片加载失败')
        }
        img.src = src
    })
    return promise
}
let src = 'https://www.imooc.com/static/img/index/logo_new.png'
let result = loadImg(src)
result.then(function(img) {
    console.log(1, img.width)
    return img
}, function() {
    console.log('error 1')
}).then(function(img) {
    console.log(2, img.height)
}).catch(function(err) {
    console.log(err)
})
</script>

<script>
let src1 = 'https://www.imooc.com/static/img/index/logo_new.png'
let result1 = loadImg(src1) //result1是Promise对象
let src2 = 'https://img1.mukewang.com/545862fe00017c2602200220-100-100.jpg'
let result2 = loadImg(src2) //result2是Promise对象
result1.then(function (img1) {
  console.log('第一个图片加载完成', img1.width)
  return result2  // 链式操作
}).then(function (img2) {
  console.log('第二个图片加载完成', img2.width)
}).catch(function (err) {
  console.log(err)
}) 

Promise.all([result1, result2]).then(function(datas) {
    console.log('all', datas[0]) //<img src="https://www.imooc.com/static/img/index/logo_new.png">
    console.log('all', datas[1]) //<img src="https://img1.mukewang.com/545862fe00017c2602200220-100-100.jpg">
}).catch(function(err) {
    console.log(err)
})
Promise.race([result1, result2]).then(function(data) {
    console.log('race', data) //<img src="https://img1.mukewang.com/545862fe00017c2602200220-100-100.jpg">
}).catch(function(err) {
    console.log(err)
})
</script> -->
<script>
function loadImg(src) {
    const promise = new Promise(function(resolve, reject) {
        const img = document.createElement('img')
        img.onload = function() {
            resolve(img)
        }
        img.onerror = function() {
            reject('图片加载失败')
        }
        img.src = src
    })
    return promise
}
const src1 = 'https://www.imooc.com/static/img/index/logo_new.png'
const src2 = 'https://img1.mukewang.com/545862fe00017c2602200220-100-100.jpg'
const load = async function() {
    const result1 = await loadImg(src1)
    console.log(result1)
    const result2 = await loadImg(src2)
    console.log(result2)
}
load()
</script>
</body>
</html>